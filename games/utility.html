<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DNA Helix Clock</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #050505; /* 深い黒 */
            color: #ffffff;
            font-family: 'Courier New', Courier, monospace; /* 科学的な雰囲気のフォント */
            overflow: hidden; /* スクロールバーを隠す */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        #container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        canvas {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
        }

        #clock-display {
            position: absolute;
            z-index: 2;
            font-size: 5rem;
            font-weight: bold;
            text-shadow: 0 0 20px rgba(0, 255, 255, 0.5), 0 0 40px rgba(0, 255, 255, 0.3);
            background: rgba(0, 0, 0, 0.4);
            padding: 20px 40px;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            user-select: none;
            letter-spacing: 5px;
        }

        .back-btn {
            position: fixed;
            top: 14px;
            left: 14px;
            z-index: 10;
            padding: 10px 14px;
            border-radius: 12px;
            background: rgba(0, 0, 0, 0.6);
            color: #0ff;
            border: 1px solid rgba(0, 255, 255, 0.6);
            text-decoration: none;
            font-weight: 700;
            letter-spacing: 1px;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.4);
        }

        .back-btn:hover { background: rgba(0, 255, 255, 0.12); }

        /* モバイル対応 */
        @media (max-width: 600px) {
            #clock-display {
                font-size: 3rem;
                padding: 15px 20px;
            }
        }
    </style>
</head>
<body>

<div id="container">
    <canvas id="dnaCanvas"></canvas>
    <div id="clock-display">00:00:00</div>
</div>

<a class="back-btn" href="../index.html">← HUB</a>

<script>
    const canvas = document.getElementById('dnaCanvas');
    const ctx = canvas.getContext('2d');
    const clockDisplay = document.getElementById('clock-display');

    let width, height;
    
    // DNAの設定パラメータ
    const settings = {
        particleCount: 40,    // 塩基対（粒）の数
        radius: 100,          // 螺旋の半径
        speed: 0.02,          // 回転速度
        verticalGap: 15,      // 粒ごとの垂直間隔
        particleSize: 4       // 粒子の基本サイズ
    };

    let timeOffset = 0; // アニメーション用の時間経過変数

    // キャンバスのリサイズ処理
    function resize() {
        width = window.innerWidth;
        height = window.innerHeight;
        canvas.width = width;
        canvas.height = height;
    }

    window.addEventListener('resize', resize);
    resize();

    // 時間の更新と表示
    function updateClock() {
        const now = new Date();
        const h = String(now.getHours()).padStart(2, '0');
        const m = String(now.getMinutes()).padStart(2, '0');
        const s = String(now.getSeconds()).padStart(2, '0');
        
        clockDisplay.innerText = `${h}:${m}:${s}`;
        
        // 時間に基づいて色相（Hue）を計算し、時計の文字色を少し変化させる
        // 秒数に基づいて色を循環させる (0-360度)
        const hue = (now.getSeconds() * 6) + (now.getMilliseconds() / 1000 * 6);
        clockDisplay.style.color = `hsl(${hue}, 80%, 70%)`;
        clockDisplay.style.textShadow = `0 0 20px hsl(${hue}, 80%, 50%)`;
        
        return hue;
    }

    // 描画ループ
    function animate() {
        // キャンバスをクリア（少し残像を残すために透明度の高い黒で塗りつぶすことも可能だが、今回は完全クリア）
        ctx.clearRect(0, 0, width, height);

        const currentHue = updateClock();
        const centerX = width / 2;
        const centerY = height / 2;

        // 全体の高さを計算して中央に配置するためのオフセット
        const totalHeight = settings.particleCount * settings.verticalGap;
        const startY = centerY - (totalHeight / 2);

        timeOffset += settings.speed;

        // 線のスタイル設定
        ctx.lineWidth = 1;

        for (let i = 0; i < settings.particleCount; i++) {
            // Y座標（上から下へ）
            const y = startY + i * settings.verticalGap;

            // 螺旋の角度計算 (y位置によるオフセット + 時間経過による回転)
            // 係数を調整して螺旋のねじれ具合を変える
            const angle = (i * 0.3) + timeOffset;

            // X座標の計算 (Sin/Cos)
            // 3D的に見せるため、radiusを変数として扱う手もあるが、今回はX軸の変位のみで表現
            const xOffset = Math.sin(angle) * settings.radius;
            
            // 奥行き（Z座標的なもの）を計算 (-1 から 1)
            // これを使ってサイズと透明度を変える
            const depth = Math.cos(angle); 
            
            // 奥行きに基づくスケールとアルファ値
            // 奥にあるものは小さく、暗くする
            const scale = 1 + (depth * 0.3); // 0.7倍 〜 1.3倍
            const alpha = 0.3 + ((depth + 1) / 2) * 0.7; // 0.3 〜 1.0

            // ストランド1（左ねじれ成分）
            const x1 = centerX + xOffset;
            // ストランド2（右ねじれ成分、180度=PIずらす）
            const x2 = centerX - xOffset;

            // 色の計算（グラデーション）
            const particleHue = (currentHue + (i * 5)) % 360;
            const color = `hsla(${particleHue}, 80%, 60%, ${alpha})`;

            // 塩基対をつなぐ線（ラング）を描画
            ctx.beginPath();
            ctx.moveTo(x1, y);
            ctx.lineTo(x2, y);
            ctx.strokeStyle = `hsla(${particleHue}, 80%, 40%, ${alpha * 0.3})`; // 線は少し薄く
            ctx.stroke();

            // 粒子1を描画
            ctx.beginPath();
            ctx.arc(x1, y, settings.particleSize * scale, 0, Math.PI * 2);
            ctx.fillStyle = color;
            ctx.fill();

            // 粒子2を描画
            ctx.beginPath();
            ctx.arc(x2, y, settings.particleSize * scale, 0, Math.PI * 2);
            ctx.fillStyle = color;
            ctx.fill();
        }

        requestAnimationFrame(animate);
    }

    // アニメーション開始
    animate();

</script>
</body>
</html>
